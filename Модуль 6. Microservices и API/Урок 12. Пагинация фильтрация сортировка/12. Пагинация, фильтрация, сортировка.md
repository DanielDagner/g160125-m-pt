–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ —Ç–µ–º–µ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ FastAPI —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º SQLAlchemy**.

## üìñ –ß—Ç–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º:
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è (pagination)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (filtering)
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (sorting)
- –ü–æ—è—Å–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ `.scalars().all()`

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫—Ä–∞—Ç–∫–æ):
- **FastAPI** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ API
- **SQLAlchemy (async)** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ PostgreSQL
- **Alembic** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

## ‚öôÔ∏è –ß—Ç–æ —Ç–∞–∫–æ–µ `scalars().all()`?
–ö–æ–≥–¥–∞ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –≤—ã –ø–∏—à–µ—Ç–µ:

```python
result = await session.execute(query)
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (`Result`). –°–∞–º –ø–æ —Å–µ–±–µ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ—É–¥–æ–±–Ω–æ–º –≤–∏–¥–µ (–∫–æ—Ä—Ç–µ–∂–∏ –¥–∞–Ω–Ω—ã—Ö).

–ú–µ—Ç–æ–¥ **`.scalars()`** –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–º–µ–Ω–Ω–æ ORM-–æ–±—ä–µ–∫—Ç—ã (–º–æ–¥–µ–ª–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ `LostItem` –∏–ª–∏ `FoundItem`). –ë–µ–∑ –Ω–µ–≥–æ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –±—ã –ø—Ä–æ—Å—Ç–æ –∫–æ—Ä—Ç–µ–∂–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é.

–ú–µ—Ç–æ–¥ `.all()` –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–∏ ORM-–æ–±—ä–µ–∫—Ç—ã –≤ —É–¥–æ–±–Ω—ã–π —Å–ø–∏—Å–æ–∫ Python.

–ò—Ç–æ–≥–æ:
```python
items = result.scalars().all()  # —Ç–µ–ø–µ—Ä—å items ‚Äì —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏
```

---

## üìë –ü–∞–≥–∏–Ω–∞—Ü–∏—è
–ü–∞–≥–∏–Ω–∞—Ü–∏—è ‚Äì —ç—Ç–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±–æ–ª—å—à–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

```python
# –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ø–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π)
query = select(models.LostItem).offset(0).limit(5)

# –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: —Å–ª–µ–¥—É—é—â–∏–µ 5 –∑–∞–ø–∏—Å–µ–π
query = select(models.LostItem).offset(5).limit(5)
```

- `.offset(N)` ‚Äì —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.
- `.limit(M)` ‚Äì —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –≤–µ—Ä–Ω—É—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–ø—É—Å–∫–∞.

---

## üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∏–∑ –ë–î —Ç–æ–ª—å–∫–æ —Ç–µ –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –Ω—É–∂–Ω—ã.

### –ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

**1) –ü–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—é:**
```python
query = select(models.LostItem).where(models.LostItem.category_id == 2)
```

**2) –ü–æ —Ç–µ–∫—Å—Ç—É (—Ä–µ–≥–∏—Å—Ç—Ä –Ω–µ –≤–∞–∂–µ–Ω):**
```python
query = select(models.FoundItem).where(models.FoundItem.location.ilike("%–°–ü–±%"))
```

**3) –ü–æ –¥–∞—Ç–µ:**
```python
week_ago = datetime.datetime.now() - datetime.timedelta(days=7)
query = select(models.LostItem).where(models.LostItem.lost_date >= week_ago)
```

---

## üîÑ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ.

**–ü—Ä–∏–º–µ—Ä—ã:**

**1) –ü–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ —Å–≤–µ–∂–∏–µ):**
```python
query = select(models.LostItem).order_by(models.LostItem.lost_date.desc())
```

**2) –ü–æ –∞–ª—Ñ–∞–≤–∏—Ç—É:**
```python
query = select(models.FoundItem).order_by(models.FoundItem.name.asc())
```

**3) –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**
```python
query = select(models.LostItem).order_by(
    asc(models.LostItem.category_id),
    desc(models.LostItem.name)
)
```

---

## üöÄ –í—Å—ë –≤–º–µ—Å—Ç–µ –≤ –æ–¥–Ω–æ–º —Ä–æ—É—Ç–µ—Ä–µ FastAPI

```python
@router.get("/", response_model=list[schemas.LostItem])
async def read_lost_items(
    db: AsyncSession = Depends(get_db),
    skip: int = Query(0, ge=0, description="–°–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å"),
    limit: int = Query(10, gt=0, description="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"),
    category_id: Optional[int] = Query(None, description="–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"),
    location: Optional[str] = Query(None, description="–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ª–æ–∫–∞—Ü–∏–∏ (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)"),
    order_by: Optional[str] = Query(None, description="–ü–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"),
    sort_desc: bool = Query(False, description="–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É–±—ã–≤–∞–Ω–∏—é")
):
    query = select(models.LostItem)

    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    if category_id:
        query = query.where(models.LostItem.category_id == category_id)

    if location:
        query = query.where(models.LostItem.location.ilike(f"%{location}%"))

    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    if order_by:
        column_attr = getattr(models.LostItem, order_by, None)
        if column_attr:
            query = query.order_by(column_attr.desc() if sort_desc else column_attr.asc())

    # –ü–∞–≥–∏–Ω–∞—Ü–∏—è
    query = query.offset(skip).limit(limit)

    result = await db.execute(query)
    items = result.scalars().all()  # —Å–ø–∏—Å–æ–∫ ORM-–æ–±—ä–µ–∫—Ç–æ–≤ LostItem

    return items
```

---

## üéØ –í—ã–≤–æ–¥—ã:
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** ‚Äì –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** ‚Äì –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∑–∞–ø–∏—Å–∏.
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** ‚Äì –¥–µ–ª–∞–µ—Ç –≤—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö —É–¥–æ–±–Ω—ã–º –∏ –ª–æ–≥–∏—á–Ω—ã–º.
- **`.scalars().all()`** ‚Äì —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –ë–î –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ ORM-–æ–±—ä–µ–∫—Ç–æ–≤, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
